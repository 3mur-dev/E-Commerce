<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ðŸ”¥ FIXED: Proper Thymeleaf syntax for title -->
    <title th:text="${param.admin != null} ? 'Admin Login - Omars Shop' : 'Login - Omars Shop'">Login - Omar's Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: { extend: {
                colors: { primary: { 50: '#eff6ff', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8' } },
                animation: { 'float': 'float 6s ease-in-out infinite', 'pulse-glow': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite' }
            }}
        }
    </script>

    <style>
        .glass-effect { backdrop-filter: blur(40px); background: rgba(255, 255, 255, 0.15); border: 1px solid rgba(255, 255, 255, 0.2); }
        .glass-effect-dark { background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(255, 255, 255, 0.1); }
        .gradient-main { background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%); }
        .gradient-admin { background: linear-gradient(135deg, #f0932b 0%, #eb4d4b 50%, #6f1ab6 100%); }
        .floating-shapes { position: absolute; width: 100%; height: 100%; overflow: hidden; z-index: 0; }
        .shape { position: absolute; background: rgba(255, 255, 255, 0.1); border-radius: 50%; animation: float 15s infinite linear; }
        .shape:nth-child(1) { width: 100px; height: 100px; top: 15%; left: 5%; animation-delay: 0s; }
        .shape:nth-child(2) { width: 150px; height: 150px; top: 70%; right: 10%; animation-delay: 4s; }
        .shape:nth-child(3) { width: 80px; height: 80px; bottom: 15%; left: 25%; animation-delay: 8s; }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-30px) rotate(120deg); }
            66% { transform: translateY(15px) rotate(240deg); }
        }
    </style>
</head>

<body th:class="${param.admin != null} ? 'gradient-admin min-h-screen flex items-center justify-center p-2 sm:p-4 md:p-6 lg:p-8 relative overflow-x-hidden' : 'gradient-main min-h-screen flex items-center justify-center p-2 sm:p-4 md:p-6 lg:p-8 relative overflow-x-auto'">

<!-- Floating Background -->
<div class="floating-shapes absolute inset-0 pointer-events-none">
    <div class="shape"></div><div class="shape"></div><div class="shape"></div>
</div>

<div th:class="${param.admin != null} ? 'w-full max-w-md relative z-10' : 'w-full max-w-4xl flex flex-col lg:flex-row items-center justify-center gap-12 lg:gap-20 relative z-10'">


    <!-- Welcome Section (Users Only) -->
    <div th:unless="${param.admin != null}" class="text-center lg:text-left max-w-md lg:max-w-lg space-y-6">
        <div class="glass-effect rounded-3xl p-8 shadow-2xl border border-white/30">
            <div class="w-20 h-20 bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center mx-auto lg:mx-0 mb-6 shadow-xl">
                <i class="fas fa-shopping-bag text-2xl text-white"></i>
            </div>
            <h1 class="text-4xl lg:text-5xl font-black bg-gradient-to-r from-white to-blue-100/90 bg-clip-text text-transparent mb-4">Welcome Back</h1>
            <p class="text-xl text-white/90 font-semibold mb-8">Sign in to continue shopping</p>
        </div>
    </div>

    <!-- SINGLE LOGIN FORM -->
    <div th:class="${param.admin != null} ? 'w-full max-w-md' : 'w-full max-w-md'">
        <div class="glass-effect rounded-3xl p-8 lg:p-10 shadow-3xl hover:shadow-4xl transition-all duration-500 border border-white/30">

            <!-- DYNAMIC BANNERS -->
            <div th:if="${param.fromCart}" class="mb-6 p-5 rounded-2xl bg-orange-500/15 border-2 border-orange-400/40 backdrop-blur-sm">
                <div class="flex items-center gap-3 mb-2">
                    <i class="fas fa-shopping-cart text-xl text-orange-300"></i>
                    <h3 class="font-bold text-lg text-orange-100">Cart Access Required</h3>
                </div>
                <p class="text-sm text-orange-100">Please sign in to view your shopping cart</p>
            </div>

            <div th:if="${param.admin != null}" class="mb-6 p-5 rounded-2xl bg-yellow-500/15 border-2 border-yellow-400/40 backdrop-blur-sm">
                <div class="flex items-center gap-3 mb-2">
                    <i class="fas fa-crown text-xl text-yellow-300"></i>
                    <h3 class="font-bold text-lg text-yellow-100">Admin Panel Access</h3>
                </div>
                <p class="text-sm text-yellow-100">Enter admin credentials</p>
            </div>

            <!-- DYNAMIC TITLES -->
            <div class="text-center mb-8">
                <div th:if="${param.admin != null}" class="w-20 h-20 bg-yellow-400/20 backdrop-blur-sm rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl border border-yellow-400/30">
                    <i class="fas fa-crown text-2xl text-yellow-200"></i>
                </div>
                <div th:unless="${param.admin != null}" class="w-20 h-20 bg-white/20 backdrop-blur-sm rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl border border-white/30">
                    <i class="fas fa-shopping-bag text-2xl text-white"></i>
                </div>

                <h2 th:if="${param.admin != null}"
                    class="text-3xl lg:text-4xl font-black bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent mb-3">
                    Admin Login
                </h2>
                <h2 th:if="${param.fromCart}"
                    class="text-3xl lg:text-4xl font-bold bg-gradient-to-r from-orange-400 via-amber-400 to-yellow-400 bg-clip-text text-transparent mb-3">
                    User Login - Cart Access
                </h2>
                <h2 th:unless="${param.admin != null or param.fromCart != null}"
                    class="text-3xl lg:text-4xl font-bold bg-gradient-to-r from-white via-blue-50 to-white/80 bg-clip-text text-transparent mb-3">
                    User Login
                </h2>

                <p th:if="${param.admin != null}" class="text-yellow-100/90 font-bold font-medium">Admin Panel Access Required</p>
                <p th:if="${param.fromCart != null}" class="text-orange-100 font-semibold">Access your shopping cart</p>
                <p th:unless="${param.admin != null or param.fromCart != null}" class="text-white/80 font-medium">Access your shopping account</p>
            </div>

            <!-- FORM -->
            <form th:action="@{/login}" method="post" class="space-y-6">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                <div class="relative">
                    <label class="block text-white/95 font-bold mb-3 flex items-center gap-2 text-lg">
                        <i th:class="${param.admin != null} ? 'fas fa-user-crown text-yellow-300' : 'fas fa-envelope text-primary-50'" class="fas fa-envelope text-primary-50"></i>
                        <span th:text="${param.admin != null} ? 'Admin Username' : 'Email Address'">Email</span>
                    </label>
                    <div class="relative">
                        <i th:class="${param.admin != null} ? 'fas fa-user-crown text-yellow-300/70' : 'fas fa-envelope'" class="fas fa-envelope absolute left-4 top-1/2 -translate-y-1/2 text-white/40 text-xl"></i>
                        <input type="text" name="username" required autocomplete="email"
                               th:with="adminPlaceholder=${param.admin != null} ? 'admin@shop.com' : 'john@example.com'"
                               th:placeholder="${adminPlaceholder}"
                               class="w-full pl-12 pr-5 py-5 rounded-2xl glass-effect-dark text-white placeholder-white/50 font-semibold text-lg backdrop-blur-sm border border-white/20 focus:border-primary-400 focus:ring-4 focus:ring-primary-500/20 focus:outline-none transition-all duration-400 hover:border-white/40 hover:shadow-2xl">
                    </div>
                </div>

                <div class="relative">
                    <label class="block text-white/95 font-bold mb-3 flex items-center gap-2 text-lg">
                        <i class="fas fa-lock text-primary-50"></i>Password
                    </label>
                    <div class="relative">
                        <i class="fas fa-lock absolute left-4 top-1/2 -translate-y-1/2 text-white/40 text-xl"></i>
                        <input type="password" name="password" required autocomplete="current-password"
                               class="w-full pl-12 pr-5 py-5 rounded-2xl glass-effect-dark text-white placeholder-white/50 font-semibold text-lg backdrop-blur-sm border border-white/20 focus:border-primary-400 focus:ring-4 focus:ring-primary-500/20 focus:outline-none transition-all duration-400 hover:border-white/40 hover:shadow-2xl"
                               placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                </div>

                <div th:unless="${param.admin != null}" class="flex items-center justify-between pt-2">
                    <label class="flex items-center gap-2 text-sm text-white/80 font-medium cursor-pointer group">
                        <input type="checkbox" name="remember-me" class="w-4 h-4 rounded bg-white/20 border-white/30 focus:ring-primary-500">
                        <span class="group-hover:text-white">Remember me</span>
                    </label>
                    <a href="#" class="text-primary-200 hover:text-white font-medium hover:underline">Forgot Password?</a>
                </div>

                <button type="submit"
                        th:class="${param.admin != null} ? 'bg-gradient-to-r from-yellow-500 via-orange-500 to-red-500 hover:from-orange-500 hover:to-red-600' : 'bg-gradient-to-r from-primary-500 via-primary-600 to-primary-700 hover:from-primary-600 hover:to-primary-800'"
                        class="w-full text-white font-black py-6 px-8 rounded-3xl shadow-2xl hover:shadow-3xl hover:-translate-y-1 transition-all duration-500 text-xl flex items-center justify-center gap-3 group backdrop-blur-sm border border-white/20">
                    <i th:class="${param.admin != null} ? 'fas fa-crown' : 'fas fa-sign-in-alt'" class="fas fa-sign-in-alt text-2xl group-hover:translate-x-1 transition-transform duration-300"></i>
                    <span th:text="${param.admin != null} ? 'Enter Admin Panel' : 'Sign In to Shop'">Sign In</span>
                </button>
            </form>

            <!-- Error Messages -->
            <div th:if="${param.error}" class="mt-8 p-6 rounded-3xl bg-red-500/10 border-2 border-red-400/40 backdrop-blur-sm text-red-100 animate-pulse">
                <div class="flex items-center gap-3 mb-2">
                    <i class="fas fa-exclamation-circle text-xl text-red-400"></i>
                    <h3 class="font-bold text-lg">Login Failed</h3>
                </div>
                <p class="text-sm">Invalid credentials. Please try again.</p>
            </div>

            <div th:if="${param.logout}" class="mt-8 p-6 rounded-3xl bg-emerald-500/10 border-2 border-emerald-400/40 backdrop-blur-sm text-emerald-100">
                <div class="flex items-center gap-3 mb-2">
                    <i class="fas fa-check-circle text-xl text-emerald-400"></i>
                    <h3 class="font-bold text-lg">Logged Out</h3>
                </div>
                <p class="text-sm">You have been successfully logged out.</p>
            </div>

            <div th:unless="${param.admin != null}" class="mt-8 pt-6 border-t border-white/20 text-center">
                <p class="text-white/80 text-sm mb-4">Don't have an account?</p>
                <a th:href="@{/register}" class="inline-flex items-center gap-3 px-8 py-4 bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white font-bold rounded-2xl shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all duration-400 border border-white/30 text-lg">
                    <i class="fas fa-user-plus"></i>Create Account
                </a>
            </div>
        </div>
    </div>
</div>

<footer class="absolute bottom-6 left-1/2 transform -translate-x-1/2 text-center text-white/50 text-xs md:text-sm">
    <p>&copy; 2026 Omar's Shop</p>
</footer>
</body>
</html>