<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Products | Omar's Shop</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    primary: {
                        50: '#eff6ff', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8', 900: '#1e3a8a'
                    }
                },
                animation: {
                    'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    'bounce-slow': 'bounce 2s infinite',
                    'fade-in': 'fadeIn 0.5s ease-in-out'
                },
                backdropBlur: {
                    xs: '2px',
                }
            }
        }
    }
  </script>

  <style>
    .glass-effect {
        backdrop-filter: blur(20px);
        background: rgba(255, 255, 255, 0.25);
        border: 1px solid rgba(255, 255, 255, 0.18);
    }
    .glass-effect-dark {
        background: rgba(15, 23, 42, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .gradient-1 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .gradient-2 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .gradient-3 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }

    .file-input-wrapper {
        position: relative;
        overflow: hidden;
        display: inline-block;
    }
    .file-input-wrapper input[type=file] {
        position: absolute;
        left: -9999px;
    }
    .file-input-label {
        display: block;
        padding: 1rem 2rem;
        border-radius: 9999px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-weight: 600;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    .file-input-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
    }

    [x-cloak] { display: none; }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 min-h-screen py-12 px-4 sm:px-6 lg:px-8">

<!-- Header -->
<header class="max-w-7xl mx-auto mb-12">
  <div class="glass-effect rounded-3xl p-8 shadow-2xl border border-white/30">
    <div class="flex flex-col lg:flex-row items-center justify-between gap-6">
      <div class="text-center lg:text-left">
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-black bg-gradient-to-r from-gray-800 via-gray-700 to-gray-900 bg-clip-text text-transparent mb-4">
          <i class="fas fa-crown text-yellow-500 mr-4"></i>
          Admin Dashboard
        </h1>
        <p class="text-xl text-gray-600 font-semibold">Products Management</p>
      </div>
      <a th:href="@{/admin}"
         class="px-8 py-4 bg-white/80 backdrop-blur-sm hover:bg-white text-gray-800 font-bold rounded-3xl shadow-2xl hover:shadow-3xl hover:-translate-y-1 transition-all duration-300 border border-white/50 text-lg flex items-center gap-3">
        <i class="fas fa-arrow-left"></i>
        Back to Dashboard
      </a>
    </div>
  </div>
</header>

<!-- Alerts -->
<div th:if="${success}" class="max-w-4xl mx-auto mb-8 animate-fade-in">
  <div class="glass-effect bg-green-500/10 text-green-800 border-green-200 p-6 rounded-3xl shadow-xl flex items-center gap-4 animate-pulse-slow">
    <i class="fas fa-check-circle text-3xl text-green-500"></i>
    <div>
      <h3 class="font-bold text-xl mb-1">Success!</h3>
      <p th:text="${success}">Product created successfully!</p>
    </div>
  </div>
</div>

<div th:if="${error}" class="max-w-4xl mx-auto mb-8 animate-fade-in">
  <div class="glass-effect bg-red-500/10 text-red-800 border-red-200 p-6 rounded-3xl shadow-xl flex items-center gap-4">
    <i class="fas fa-exclamation-triangle text-3xl text-red-500"></i>
    <span th:text="${error}">Error message</span>
  </div>
</div>

<!-- Add Product Form -->
<div class="max-w-7xl mx-auto mb-12">
  <div class="glass-effect rounded-3xl p-8 lg:p-12 shadow-2xl hover:shadow-3xl transition-all duration-500 border border-white/40 animate-fade-in">
    <h2 class="text-3xl font-bold bg-gradient-to-r from-primary-600 to-primary-700 bg-clip-text text-transparent mb-8 flex items-center gap-3">
      <i class="fas fa-plus-circle text-4xl"></i>
      Add New Product
    </h2>

    <form th:action="@{/admin/products/add}" method="post" enctype="multipart/form-data" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

      <!-- Product Name -->
      <div class="space-y-2">
        <label class="font-bold text-gray-700 flex items-center gap-2">
          <i class="fas fa-tag text-primary-500"></i>
          Product Name
        </label>
        <input type="text" name="name" required
               class="w-full p-5 rounded-2xl border-2 border-gray-200 focus:border-primary-500 focus:ring-4 focus:ring-primary-500/20 bg-white/70 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 text-lg"
               placeholder="iPhone 15 Pro Max">
      </div>

      <!-- Price -->
      <div class="space-y-2">
        <label class="font-bold text-gray-700 flex items-center gap-2">
          <i class="fas fa-dollar-sign text-green-500"></i>
          Price
        </label>
        <input type="number" name="price" step="0.01" min="0" required
               class="w-full p-5 rounded-2xl border-2 border-gray-200 focus:border-green-500 focus:ring-4 focus:ring-green-500/20 bg-white/70 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 text-lg"
               placeholder="999.99">
      </div>

      <!-- Stock -->
      <div class="space-y-2">
        <label class="font-bold text-gray-700 flex items-center gap-2">
          <i class="fas fa-boxes text-blue-500"></i>
          Stock
        </label>
        <input type="number" name="stock" min="0" required
               class="w-full p-5 rounded-2xl border-2 border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-500/20 bg-white/70 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 text-lg"
               placeholder="50">
      </div>

      <!-- Category -->
      <div class="space-y-2 md:col-span-2 lg:col-span-1">
        <label class="font-bold text-gray-700 flex items-center gap-2">
          <i class="fas fa-layer-group text-purple-500"></i>
          Category
        </label>
        <select name="categoryId" required
                class="w-full p-5 rounded-2xl border-2 border-gray-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-500/20 bg-white/70 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 text-lg">
          <option value="" disabled selected>Choose category</option>
          <option th:each="cat : ${categories}"
                  th:value="${cat.id}"
                  th:text="${cat.name}"
                  class="py-3"></option>
        </select>
      </div>

      <!-- Image Upload -->
      <div class="space-y-4 md:col-span-2 lg:col-span-1">
        <label class="font-bold text-gray-700 flex items-center gap-2 mb-4">
          <i class="fas fa-image text-pink-500 text-2xl"></i>
          Product Image
        </label>
        <div class="file-input-wrapper w-full">
          <input type="file" name="image" accept="image/*" required
                 class="file-input-hidden" id="imageInput">
          <label for="imageInput" class="file-input-label w-full flex items-center justify-center gap-3 text-lg">
            <i class="fas fa-cloud-upload-alt animate-bounce-slow"></i>
            <span>Choose Image (JPG, PNG, WebP)</span>
            <i class="fas fa-arrow-up text-xs opacity-75"></i>
          </label>
        </div>
        <p class="text-sm text-gray-500 text-center mt-2">Max 10MB â€¢ Recommended 600x600px</p>
      </div>

      <!-- Submit Button -->
      <div class="md:col-span-2 lg:col-span-3 pt-4">
        <button type="submit"
                class="w-full bg-gradient-to-r from-primary-600 via-primary-500 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white font-black py-6 px-12 rounded-3xl shadow-2xl hover:shadow-3xl hover:-translate-y-2 transition-all duration-500 text-xl flex items-center justify-center gap-4 group">
          <i class="fas fa-rocket text-2xl group-hover:translate-x-2 transition-transform duration-300"></i>
          <span>Create Product</span>
          <i class="fas fa-magic text-xl opacity-75 group-hover:opacity-100 transition-opacity"></i>
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Products Table -->
<div class="max-w-7xl mx-auto">
  <div class="glass-effect rounded-3xl p-8 shadow-2xl hover:shadow-3xl transition-all duration-500 border border-white/40 overflow-hidden">
    <div class="flex flex-col sm:flex-row items-center justify-between mb-8 gap-4">
      <h2 class="text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3">
        <i class="fas fa-list text-4xl"></i>
        All Products
        <span class="bg-primary-500/20 text-primary-700 text-sm font-bold px-4 py-1 rounded-2xl border border-primary-200">
                        <span th:text="${#lists.size(products)}">12</span> Products
                    </span>
      </h2>
    </div>

    <!-- Products Grid -->
    <div class="overflow-x-auto">
      <table class="w-full text-left">
        <thead>
        <tr class="bg-gradient-to-r from-gray-50 to-gray-100 border-b-2 border-gray-200">
          <th class="px-6 py-5 font-bold text-gray-700 uppercase text-xs tracking-wider rounded-tl-2xl">ID</th>
          <th class="px-6 py-5 font-bold text-gray-700 uppercase text-xs tracking-wider">Product</th>
          <th class="px-6 py-5 font-bold text-gray-700 uppercase text-xs tracking-wider text-center">Price</th>
          <th class="px-6 py-5 font-bold text-gray-700 uppercase text-xs tracking-wider text-center">Stock</th>
          <th class="px-6 py-5 font-bold text-gray-700 uppercase text-xs tracking-wider text-center rounded-tr-2xl">Actions</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
        <tr th:each="product : ${products}"
            class="group hover:bg-white/60 hover:backdrop-blur-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-1 border-b border-gray-100 hover:border-primary-200">

          <td class="px-6 py-6 font-mono text-sm text-gray-500 font-bold" th:text="${product.id}">1</td>
          <td class="px-6 py-6">
            <div class="flex items-center gap-4">
              <div class="w-14 h-14 rounded-2xl overflow-hidden shadow-lg bg-gradient-to-br from-gray-100 to-gray-200 group-hover:scale-110 transition-transform duration-300">
                <img th:src="${product.imageUrl} ?: '/images/default.webp'"
                     th:alt="${product.name}"
                     class="w-full h-full object-cover">
              </div>
              <div>
                <div class="font-bold text-lg text-gray-900 group-hover:text-primary-600 transition-colors" th:text="${product.name}">Product Name</div>
                <div class="text-sm text-gray-500" th:text="'ID: ' + ${product.categoryId}">Category ID: 1</div>
              </div>
            </div>
          </td>
          <td class="px-6 py-6 text-center">
            <div class="font-bold text-2xl text-green-600" th:text="'$' + ${#numbers.formatDecimal(product.price, 1, 'COMMA', 2, 'POINT')}">$99.99</div>
          </td>
          <td class="px-6 py-6 text-center">
                                <span th:if="${product.stock > 0}"
                                      class="inline-flex items-center px-4 py-2 bg-green-100 text-green-800 font-bold rounded-2xl text-lg"
                                      th:text="${product.stock}">50</span>
            <span th:if="${product.stock <= 0}"
                  class="inline-flex items-center px-4 py-2 bg-red-100 text-red-800 font-bold rounded-2xl text-lg">0</span>
          </td>
          <td class="px-6 py-6 text-center">
            <div class="flex items-center justify-center gap-2">
              <a th:href="@{'/admin/products/edit/' + ${product.id}}"
                 class="group relative p-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 hover:-translate-y-1">
                <i class="fas fa-edit text-lg group-hover:rotate-12 transition-transform"></i>
                <span class="absolute -top-10 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap">Edit</span>
              </a>
              <form th:action="@{'/admin/products/delete/' + ${product.id}}" method="post" class="inline"
                    onsubmit="return confirm('Delete this product?')">
                <button type="submit"
                        class="group p-3 bg-gradient-to-r from-red-500 to-red-600 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 hover:-translate-y-1 ml-2">
                  <i class="fas fa-trash text-lg group-hover:scale-110 transition-transform"></i>
                  <span class="absolute -top-10 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-all duration-300 whitespace-nowrap">Delete</span>
                </button>
              </form>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Footer -->
<footer class="mt-24 pt-12 pb-8 glass-effect-dark text-white text-center rounded-3xl mx-auto max-w-4xl shadow-2xl border border-white/10">
  <p class="text-xl font-semibold opacity-95">&copy; 2026 Omar's Shop Admin. All rights reserved.</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/@alpinejs/3.13.5/dist/cdn.min.js" defer></script>
</body>
</html>